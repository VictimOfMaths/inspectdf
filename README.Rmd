---
output: github_document
---

```{r, echo = FALSE}
knitr::opts_chunk$set(
  fig.path = "man/figures/README-"
)
```


# reporter <img src="man/figures/hex.png" align="right" width="120" />


[![Build Status](https://travis-ci.org/alastairrushworth/reporter.svg?branch=master)](https://travis-ci.org/alastairrushworth/reporter)  [![codecov](https://codecov.io/gh/alastairrushworth/reporter/branch/master/graph/badge.svg)](https://codecov.io/gh/alastairrushworth/reporter)


Overview
---

`reporter` is collection of utilities for columnwise summary, comparison and visualisation of data frames.  Functions are provided to report missingness, categorical levels, numeric distribution, correlation, column types and memory usage.  

The package has three aims:  
+ to speed up repetitive checking and exploratory tasks for data frames
+ to make it easier to compare data frames for differences and inconsistencies  
+ to support quick visualisation of data frames




Installation 
---

To install the development version of the package, use the command
```{r, eval = FALSE}
devtools::install_github("alastairrushworth/reporter")
```

Then load the package and the `starwars` data.
```{r}
# load reporter
library(reporter)

# some example data
data(starwars, package = "dplyr")
```


## Single data frame summaries

#### Column types 

To explore the column types in a data frame, use the function `report_types`.  The command returns a tibble summarising the percentage of columns with the a particular type.  A barplot is also returned when `show_plot = TRUE`.

```{r}
# return tibble and visualisation of columns types
report_types(starwars, show_plot = T)
```


#### Memory usage

To explore the memory usage of the columns in a data frame, use the function `report_mem`.  The command returns a tibble containing the memory usage and percentage of total usage for each column in the data frame.  A barplot is also returned when `show_plot = TRUE`.

```{r}
report_mem(starwars, show_plot = T)
```

#### Missing values

`report_na` is used to report the number and proportion of missing values contained within each column in a data frame.  The command returns a tibble containing the count (`cnt_na`) and the overall percentage (`pcnt_na`) of missing values by column in the data frame.  A barplot is also returned when `show_plot` is set to `TRUE`.

```{r}
report_na(starwars, show_plot = T)
```


#### Correlation

`report_cor` returns a tibble containing Pearson's correlation coefficient, confidence intervals and $p$-values between pairs of numeric columns in a data frame.  The function combines the functionality of `cor()` and `cor.test()` into a more useable wrapper.  An point and whiskers plot is also returned when `show_plot = TRUE`.

```{r}
report_cor(starwars, show_plot = T)
```

__Notes__

+ The tibble is sorted in descending order of the absolute coefficient.  
+ `report_cor` drops missing values prior to calculation of each correlation coefficient.  
+ The `p_value` column is associated with the null hypothesis $H_0: \rho = 0$.

#### Feature imbalance

Categorical features where each element is identical (or nearly) are often removed or scrutinised more closely.  The function `report_imbalance` helps to find categorical columns that are dominated by a single feature level and returns a tibble containing the columns: `col_name` the categorical column names; `value` the most frequently occurring categorical level in each column; `percent` the percentage frequency with which the value occurs.  The tibble is sorted in descending order of the `percent`.  A barplot is also returned when `show_plot` is set to `TRUE`.

```{r}
report_imb(starwars, show_plot = T)
```


#### Numeric summaries

`report_num` generates statistical summaries of numeric columns contained in a data frame, combining some of the functionality of `summary` and `hist`.  The tibble returned contains standard numerical summaries (min, max, mean, median etc.), but also the percentage of missing entries (`percent_na`) and a simple histogram (`hist`).  If `show_plot = TRUE` a histogram is generated for each numeric feature.

```{r}
report_num(starwars, show_plot = T, breaks = 10)
```

The `hist` column is a list whose elements are tibbles each containing a simple histogram with the relative frequency of counts for each feature.  These tibbles are used to generate the histograms shown when `show_plot = TRUE`.  For example, the histogram for `starwars$birth_year` is

```{r}
report_num(starwars)$hist$birth_year
```

#### Categorical levels

`report_cat` returns a tibble summarising categorical features in the data frame.  This combines the functionality of `report_imbalance` and the `table` function. If `show_plot = TRUE` a barplot is generated showing the relative split.  The tibble generated contains the columns  

+ `col_name` name of the column
+ `cnt` the number of unique levels in the feature  
+ `common` the most common level (see also `report_imb`)  
+ `common_pcnt` the percentage occurrence of the most dominant level  
+ `levels` a list of tibbles each containing frequency tabulations of all levels. 

```{r}
report_cat(starwars, show_plot = T)
```

For example, the levels for the `hair_color` column are

```{r}
report_cat(starwars)$levels$hair_color
```

Note that by default, if `NA` values are present, they are counted as a distinct categorical level.


## Comparing data frames

In addition to printing summaries for a single data frame, each `report_` function can accept two dataframe objects and produces statistics and plots comparing the two dataframes.

#### Example

To keep things simple, suppose we take the `starwars` data and produce two new dataframes `star_1` and `star_2` that randomly sample the rows of the original and drop a couple of columns.

```{r, message=FALSE, warning=FALSE}
library(dplyr)
star_1 <- starwars %>% sample_n(50)
star_2 <- starwars %>% sample_n(50) %>% select(-1, -2)
```

#### Comparing column types

When a second dataframe is provided, `report_types` will create a dataframe comparing the count and percentage of each column type.  To enable an easy comparison, the dataframe names are embedded into the column names.    

```{r}
report_types(star_1, star_2, show_plot = T)
```

+ Comparison of column types between the two data frames 


